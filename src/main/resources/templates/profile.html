<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(
          title='Perfil', cssFile='style_profile.css', activePage='perfil',
          content=~{::content})}">

<body>
  <div th:fragment="content">
    <div class="container py-5">
      <h1 class="fw-bold mb-4">Mi Perfil</h1>

      <!-- Mensajes de éxito/error -->
      <div th:if="${message}" class="alert alert-success alert-dismissible fade show" role="alert">
        <span th:text="${message}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
        <span th:text="${error}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>

      <div th:if="${user}" class="row">
        <div class="col-md-6">
          <form th:action="@{/user/update}" method="post" th:object="${profileUpdateRequest}">
            <div class="mb-3">
              <label class="form-label">Usuario</label>
              <input type="text" class="form-control" th:field="*{username}" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Email</label>
              <input type="email" class="form-control" th:field="*{email}" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Teléfono</label>
              <input type="tel" class="form-control" th:field="*{telefono}" required pattern="[0-9]{9}"
                title="Debe tener 9 dígitos">
            </div>
            <div class="mb-3">
              <label class="form-label">Nueva Contraseña (deja vacío para no cambiar)</label>
              <input type="password" class="form-control" th:field="*{newPassword}">
            </div>
            <button type="submit" class="btn btn-accion">Actualizar Perfil</button>
          </form>
        </div>
        <div class="col-md-6">
          <h5>Información Actual</h5>
          <p><strong>Usuario:</strong> <span th:text="${user.username}"></span></p>
          <p><strong>Email:</strong> <span th:text="${user.email}"></span></p>
          <p><strong>Teléfono:</strong> <span th:text="${user.telefono}"></span></p>
          <p><strong>Role:</strong> <span th:text="${user.role}"></span></p>
          <p><strong>Fecha Creación:</strong> <span
              th:text="${#temporals.format(user.createdAt, 'dd-MM-yyyy HH:mm')}"></span></p>
        </div>
      </div>
    </div>
  </div>
</body>

</html>